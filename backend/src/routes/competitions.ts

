import express from "express";
import {
  createCompetition,
  listCompetitions,
  getCompetitionById,
  updateCompetition,
  deleteCompetition,
  addAthleteToCompetition,
  removeAthleteFromCompetition,
  getCompetitionParticipants,
  recordCompetitionResult,
} from "../controllers/competitions.controller";
import { requireAuth } from "../middleware/auth.middleware";

const router = express.Router();

/**
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ† Competition Management Routes
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 */

// ğŸ“Œ Create a new competition (Admin or Coach)
router.post("/", requireAuth, createCompetition);

// ğŸ“‹ List all competitions (optionally filter by institutionId, date range)
router.get("/", requireAuth, listCompetitions);

// ğŸ” Get details of a specific competition (with participants)
router.get("/:id", requireAuth, getCompetitionById);

// âœï¸ Update competition details (Admin or Coach)
router.put("/:id", requireAuth, updateCompetition);

// âŒ Delete a competition (Admin only)
router.delete("/:id", requireAuth, deleteCompetition);

// â• Add an athlete to a competition
router.post("/:id/add-athlete", requireAuth, addAthleteToCompetition);

// â– Remove athlete from competition
router.delete("/:id/remove-athlete/:athleteId", requireAuth, removeAthleteFromCompetition);

// ğŸ‘¥ Get all participants of a competition
router.get("/:id/participants", requireAuth, getCompetitionParticipants);

// ğŸ¥‡ Record athleteâ€™s result/performance in the competition
router.post("/:id/record-result", requireAuth, recordCompetitionResult);

export default router;