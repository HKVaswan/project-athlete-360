import express from "express";
import {
  createCompetition,
  listCompetitions,
  getCompetitionById,
  updateCompetition,
  deleteCompetition,
  addAthleteToCompetition,
  removeAthleteFromCompetition,
  getCompetitionParticipants,
  recordCompetitionResult,
} from "../controllers/competitions.controller";
import { requireAuth } from "../middleware/auth.middleware";

const router = express.Router();

/**
 * ───────────────────────────────
 * 🏆 Competition Management Routes
 * ───────────────────────────────
 */

// 📌 Create a new competition (Admin or Coach)
router.post("/", requireAuth, createCompetition);

// 📋 List all competitions (optionally filter by institutionId, date range)
router.get("/", requireAuth, listCompetitions);

// 🔍 Get details of a specific competition (with participants)
router.get("/:id", requireAuth, getCompetitionById);

// ✏️ Update competition details (Admin or Coach)
router.put("/:id", requireAuth, updateCompetition);

// ❌ Delete a competition (Admin only)
router.delete("/:id", requireAuth, deleteCompetition);

// ➕ Add an athlete to a competition
router.post("/:id/add-athlete", requireAuth, addAthleteToCompetition);

// ➖ Remove athlete from competition
router.delete("/:id/remove-athlete/:athleteId", requireAuth, removeAthleteFromCompetition);

// 👥 Get all participants of a competition
router.get("/:id/participants", requireAuth, getCompetitionParticipants);

// 🥇 Record athlete’s result/performance in the competition
router.post("/:id/record-result", requireAuth, recordCompetitionResult);

export default router;